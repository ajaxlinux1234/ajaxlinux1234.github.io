"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[704,750,418,975,619],{22833:function(R,n,t){t.r(n),t.d(n,{default:function(){return P}});var S=t(52510),l=t.n(S),E=t(84875),v=t.n(E),g={avatar:"avatar___V3O9H"},u=t(62086),o;(function(e){e.CIRCLE="circle",e.SQUARE="square"})(o||(o={}));function P(e){var f=e.info.shape===o.SQUARE,a=v()({"h-8":!0,"w-8":!0,"min-w-max":!0}),r=v()(l()({"h-full w-8 bg-sky-400 content-center":!0,rounded:f,"rounded-full":!f},g.avatar,!0));if(e.info.avatar)return(0,u.jsx)("div",{className:a,children:(0,u.jsx)("img",{className:"h-full w-full",src:e.info.avatar})});var j=(e.info.nickname||e.info.name)[0];return(0,u.jsx)("div",{className:a,children:(0,u.jsx)("div",{className:r,children:j})})}},83773:function(R,n,t){t.r(n),t.d(n,{IN:function(){return S}});var S="in"},80038:function(R,n,t){t.r(n),t.d(n,{default:function(){return f}});var S=t(52510),l=t.n(S),E=t(84875),v=t.n(E),g={box:"box___k83VP",msgBox:"msgBox___CLTFk",in:"in___FxKfJ",out:"out___dQC37",system:"system___fGfxg",systemText:"systemText___emM3a"},u=t(87848),o=t(83773),P=t(22833),e=t(62086);function f(a){var r;if(a.message.type===u.MessageType.SYSTEM)return typeof a.message.message!="string"?null:(0,e.jsx)("div",{className:g.system,children:(0,e.jsx)("div",{className:g.systemText,children:a.message.message})});var j=a.message.sendType===o.IN,M=v()((r={},l()(r,g.in,j),l()(r,g.out,!j),l()(r,g.box,!0),r)),O=v()({"flex flex-col":!0,"ml-2":j,"mr-2":!j}),B=v()({"text-xs text-gray-300":!0,"text-right":!j}),I=a.member.nickname||a.member.name;return(0,e.jsxs)("div",{className:M,children:[(0,e.jsx)(P.default,{info:a.member}),(0,e.jsxs)("div",{className:O,children:[(0,e.jsx)("p",{className:B,children:I}),(0,e.jsx)("div",{style:a.style,className:g.msgBox,children:a.children})]})]})}},78318:function(R,n,t){t.r(n),t.d(n,{default:function(){return L}});var S=t(52510),l=t.n(S),E=t(57213),v=t.n(E),g=t(54306),u=t.n(g),o=t(93236),P=t(49084);function e(T,N,K){var s=T==null?void 0:(0,P.Z)(T,N);return s===void 0?K:s}var f=e,a=t(80038),r=t(23336),j=t(93588),M=t(94338),O=t(98857),B=t(74183),I=t(84544),Q=t(74229),X=t(53056),$=t(75524),i=t(62086);function L(T){if(!f(T.list,"length"))return null;var N=(0,o.useState)({}),K=u()(N,2),s=K[0],H=K[1],F=function(U,D){H(v()(v()({},s),{},l()({},U.uuid,D)))};return(0,i.jsx)("div",{className:"p-4",children:T.list.map(function(d){var U=T.members.find(function(J){return J.id===d.sendId})||{id:String(+new Date),name:""},D=s[d.uuid];return(0,i.jsx)(a.default,{style:D,member:U,message:d,children:{system:(0,i.jsx)(r.default,{message:d}),text:(0,i.jsx)(j.default,{message:d}),voice:(0,i.jsx)(M.default,{message:d}),video:(0,i.jsx)(O.default,{message:d}),file:(0,i.jsx)(B.default,{message:d}),robot:(0,i.jsx)(I.default,{message:d}),richtext:(0,i.jsx)(Q.default,{message:d}),quote:(0,i.jsx)(X.default,{onSetStyleMap:F,message:d}),img:(0,i.jsx)($.default,{message:d})}[d.type]},d.uuid)})})}},23336:function(R,n,t){t.r(n),t.d(n,{default:function(){return l}});var S=t(62086);function l(E){return(0,S.jsx)("div",{})}},24552:function(R,n,t){t.r(n),t.d(n,{default:function(){return tt}});var S=t(54306),l=t.n(S),E=t(12342),v=t.n(E),g=t(57213),u=t.n(g),o=t(93236),P=t(17607),e=t(66466),f=t(22018),a=t(22978),r=t(48721),j=t(61793),M=t(85108),O=t(6420),B=t(79766),I=t(93900),Q=t(80382),X=t(66680),$=t(88825),i={editor:"editor___AcobX",emojiBox:"emojiBox___OCwv_",count:"count___gjETG",counterOverLimit:"counterOverLimit___m7ZyI",emoji:"emoji___kcUix"},L={mention:"mention___e08UF",mentionSuggestions:"mentionSuggestions___xV0Oy",mentionSuggestionsEntryContainer:"mentionSuggestionsEntryContainer___RS_bu",mentionSuggestionsEntryContainerLeft:"mentionSuggestionsEntryContainerLeft___Obkfm",mentionSuggestionsEntryContainerRight:"mentionSuggestionsEntryContainerRight___aAbxo",mentionSuggestionsEntry:"mentionSuggestionsEntry___c0x64",mentionSuggestionsEntryFocused:"mentionSuggestionsEntryFocused___jKUAV",mentionSuggestionsEntryText:"mentionSuggestionsEntryText___uC5ih",mentionSuggestionsEntryTitle:"mentionSuggestionsEntryTitle___feT0M",mentionSuggestionsEntryAvatar:"mentionSuggestionsEntryAvatar___ar8FJ"},T=t(52007),N=t(87848),K=t(12881),s=t(62086),H=["mention","theme","searchValue","isFocused"],F=(0,j.Z)({useNativeArt:!0,positionSuggestions:function(){return{top:"10px"}}}),d=(0,M.Z)(),U=F.EmojiSuggestions,D=F.EmojiSelect,J=(0,O.Z)({component:function(C){var c=C.href,Z=(0,P.Z)(C,["className"]);return(0,s.jsx)("a",u()(u()({},Z),{},{style:{color:"#5e93c5",textDecoration:"none"},onClick:function(){return window.open(c,"_blank")}}))}}),Y=(0,B.Z)({theme:{counter:i.counter,counterOverLimit:i.counterOverLimit}}),w=Y.CharCounter,Et=f.KeyBindingUtil.hasCommandModifier;function q(h){return h.code==="KeyZ"?"undo":h.keyCode===13&&!h.shiftKey?"send-msg":(0,f.getDefaultKeyBinding)(h)}function _(h){var C=h.mention,c=h.theme,Z=h.searchValue,W=h.isFocused,V=v()(h,H);return(0,s.jsx)("div",u()(u()({},V),{},{children:(0,s.jsx)("div",{className:c==null?void 0:c.mentionSuggestionsEntryContainer,children:(0,s.jsxs)("div",{className:c==null?void 0:c.mentionSuggestionsEntryContainerRight,children:[(0,s.jsx)("div",{className:c==null?void 0:c.mentionSuggestionsEntryText,children:C.name}),(0,s.jsx)("div",{className:c==null?void 0:c.mentionSuggestionsEntryTitle,children:C.title})]})})}))}function tt(h){var C=(0,o.useRef)(null),c=(0,o.useState)(function(){return f.EditorState.createEmpty()}),Z=l()(c,2),W=Z[0],V=Z[1],nt=(0,o.useState)(!1),z=l()(nt,2),et=z[0],st=z[1],at=(0,e.tT)("im.member"),b=at.members,it=(0,e.tT)("im.message"),ot=it.setMessages,rt=(0,o.useState)(b),p=l()(rt,2),lt=p[0],ut=p[1],k=(0,o.useMemo)(function(){var y=(0,r.ZP)({entityMutability:"IMMUTABLE",theme:L,mentionPrefix:"@",supportWhitespace:!0}),m=y.MentionSuggestions,x=[y,F,d,J,Y];return{plugins:x,MentionSuggestions:m}},[]),dt=k.MentionSuggestions,mt=k.plugins,vt=(0,o.useCallback)(function(y){V(y)},[]),gt=(0,o.useCallback)(function(y){st(y)},[]),ft=(0,o.useCallback)(function(y){var m=y.value;ut((0,r.zk)(m,b))},[]),ct=function(){var m=f.EditorState.createEmpty();V(m),setTimeout(function(){var x,A;(x=C.current)===null||x===void 0||x.blur(),(A=C.current)===null||A===void 0||A.focus()})},yt=function(){var m,x;if((m=C.current.editor.editor)!==null&&m!==void 0&&m.firstChild){var A=(0,T.createElementMap)((x=C.current.editor.editor)===null||x===void 0?void 0:x.firstChild);ot({type:N.MessageType.RICHTEXT,uuid:(0,K.Z)(),sendId:"2",send:"\u674E\u56DB",message:[A],createTime:+new Date,sendType:N.SendType.OUT}),ct(),setTimeout(function(){var G;(G=h.messageRef)===null||G===void 0||G.scrollTo({top:9999999999999,behavior:"smooth"})})}},xt=function(m){var x=W.getCurrentContent(),A=x.createEntity("IMAGE","IMMUTABLE",{src:m}),G=A.getLastCreatedEntityKey(),jt=f.EditorState.set(W,{currentContent:A});return f.AtomicBlockUtils.insertAtomicBlock(jt,G," ")},St=function(m){var x=URL.createObjectURL(new Blob(m));V(xt(x))},ht=function(m){return m==="send-msg"?(yt(),"handled"):"not-handled"};return(0,s.jsxs)("div",{className:i.editor,onClick:function(){C.current.focus()},children:[(0,s.jsx)("div",{className:i.emojiBox,children:(0,s.jsx)(D,{})}),(0,s.jsx)(a.ZP,{editorKey:"editor",editorState:W,onChange:vt,plugins:mt,ref:C,keyBindingFn:q,handleKeyCommand:ht,handlePastedFiles:St}),(0,s.jsxs)("span",{className:i.count,children:[(0,s.jsx)(w,{limit:2e4}),"/20000"]}),(0,s.jsx)(U,{}),(0,s.jsx)(dt,{open:et,onOpenChange:gt,suggestions:lt,onSearchChange:ft,onAddMention:function(){},entryComponent:_,popoverContainer:function(m){var x=m.children;return(0,s.jsx)("div",{style:{minWidth:"100px",position:"absolute"},children:x})}})]})}},21716:function(R,n,t){t.r(n),t.d(n,{default:function(){return v}});var S=t(93236),l=t(24552),E=t(62086);function v(g){return(0,E.jsx)(l.default,{messageRef:g.messageRef})}},86751:function(R,n,t){t.r(n),t.d(n,{default:function(){return j}});var S=t(54306),l=t.n(S),E=t(52510),v=t.n(E),g=t(78318),u={box:"box___IpXK4",messages:"messages___GotYm",send:"send___nFnTt"},o=t(21716),P=t(84875),e=t.n(P),f=t(66466),a=t(93236),r=t(62086);function j(){var M,O=e()((M={},v()(M,u.send,!0),v()(M,"unreset",!0),M)),B=(0,f.tT)("im.message"),I=B.messages,Q=(0,f.tT)("im.member"),X=Q.members,$=(0,a.useState)(null),i=l()($,2),L=i[0],T=i[1],N=(0,a.useRef)(null);return(0,a.useEffect)(function(){T(N.current)},[]),(0,r.jsxs)("div",{className:u.box,children:[(0,r.jsx)("div",{ref:N,className:u.messages,children:(0,r.jsx)(g.default,{list:I,members:X})}),(0,r.jsx)("div",{className:O,children:(0,r.jsx)(o.default,{messageRef:L})})]})}}}]);
