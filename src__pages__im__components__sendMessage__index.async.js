"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[681,521,128],{24552:function(H,c,e){e.r(c),e.d(c,{default:function(){return q}});var T=e(54306),g=e.n(T),x=e(12342),M=e.n(x),B=e(57213),E=e.n(B),m=e(93236),D=e(17607),O=e(66466),v=e(22018),L=e(22978),p=e(48721),R=e(61793),K=e(85108),I=e(6420),W=e(79766),X=e(93900),F=e(80382),N=e(66680),Z=e(88825),y={editor:"editor___AcobX",emojiBox:"emojiBox___OCwv_",count:"count___gjETG",counterOverLimit:"counterOverLimit___m7ZyI"},P={mention:"mention___e08UF",mentionSuggestions:"mentionSuggestions___xV0Oy",mentionSuggestionsEntryContainer:"mentionSuggestionsEntryContainer___RS_bu",mentionSuggestionsEntryContainerLeft:"mentionSuggestionsEntryContainerLeft___Obkfm",mentionSuggestionsEntryContainerRight:"mentionSuggestionsEntryContainerRight___aAbxo",mentionSuggestionsEntry:"mentionSuggestionsEntry___c0x64",mentionSuggestionsEntryFocused:"mentionSuggestionsEntryFocused___jKUAV",mentionSuggestionsEntryText:"mentionSuggestionsEntryText___uC5ih",mentionSuggestionsEntryTitle:"mentionSuggestionsEntryTitle___feT0M",mentionSuggestionsEntryAvatar:"mentionSuggestionsEntryAvatar___ar8FJ"},V=e(52007),j=e(87848),r=e(12881),n=e(62086),t=["mention","theme","searchValue","isFocused"],o=(0,R.Z)({useNativeArt:!0}),i=(0,K.Z)(),a=o.EmojiSuggestions,f=o.EmojiSelect,b=(0,I.Z)({component:function(C){var s=C.href,S=(0,D.Z)(C,["className"]);return(0,n.jsx)("a",E()(E()({},S),{},{style:{color:"#5e93c5",textDecoration:"none"},onClick:function(){return window.open(s,"_blank")}}))}}),h=(0,W.Z)({theme:{counter:y.counter,counterOverLimit:y.counterOverLimit}}),Y=h.CharCounter,bn=v.KeyBindingUtil.hasCommandModifier;function k(u){return u.code==="KeyZ"?"undo":u.keyCode===13&&!u.shiftKey?"send-msg":(0,v.getDefaultKeyBinding)(u)}function w(u){var C=u.mention,s=u.theme,S=u.searchValue,A=u.isFocused,G=M()(u,t);return(0,n.jsx)("div",E()(E()({},G),{},{children:(0,n.jsx)("div",{className:s==null?void 0:s.mentionSuggestionsEntryContainer,children:(0,n.jsxs)("div",{className:s==null?void 0:s.mentionSuggestionsEntryContainerRight,children:[(0,n.jsx)("div",{className:s==null?void 0:s.mentionSuggestionsEntryText,children:C.name}),(0,n.jsx)("div",{className:s==null?void 0:s.mentionSuggestionsEntryTitle,children:C.title})]})})}))}function q(){var u=(0,m.useRef)(null),C=(0,m.useState)(function(){return v.EditorState.createEmpty()}),s=g()(C,2),S=s[0],A=s[1],G=(0,m.useState)(!1),z=g()(G,2),nn=z[0],en=z[1],tn=(0,O.tT)("im.member"),J=tn.members,on=(0,O.tT)("im.message"),rn=on.setMessages,sn=(0,m.useState)(J),$=g()(sn,2),un=$[0],an=$[1],Q=(0,m.useMemo)(function(){var l=(0,p.ZP)({entityMutability:"IMMUTABLE",theme:P,mentionPrefix:"@",supportWhitespace:!0}),_=l.MentionSuggestions,d=[l,o,i,b,h];return{plugins:d,MentionSuggestions:_}},[]),ln=Q.MentionSuggestions,_n=Q.plugins,dn=(0,m.useCallback)(function(l){A(l)},[]),mn=(0,m.useCallback)(function(l){en(l)},[]),cn=(0,m.useCallback)(function(l){var _=l.value;an((0,p.zk)(_,J))},[]),gn=function(){var _,d;if((_=u.current.editor.editor)!==null&&_!==void 0&&_.firstChild){var U=(0,V.createElementMap)((d=u.current.editor.editor)===null||d===void 0?void 0:d.firstChild);rn({type:j.MessageType.RICHTEXT,uuid:(0,r.Z)(),sendId:"2",send:"\u674E\u56DB",message:[U],createTime:+new Date,sendType:j.SendType.OUT})}},vn=function(_){var d=S.getCurrentContent(),U=d.createEntity("IMAGE","IMMUTABLE",{src:_}),En=U.getLastCreatedEntityKey(),yn=v.EditorState.set(S,{currentContent:U});return v.AtomicBlockUtils.insertAtomicBlock(yn,En," ")},fn=function(_){var d=URL.createObjectURL(new Blob(_));A(vn(d))},hn=function(_){return _==="send-msg"?(gn(),"handled"):"not-handled"};return(0,n.jsxs)("div",{className:y.editor,onClick:function(){u.current.focus()},children:[(0,n.jsx)("div",{className:y.emojiBox,children:(0,n.jsx)(f,{})}),(0,n.jsx)(L.ZP,{editorKey:"editor",editorState:S,onChange:dn,plugins:_n,ref:u,keyBindingFn:k,handleKeyCommand:hn,handlePastedFiles:fn}),(0,n.jsxs)("span",{className:y.count,children:[(0,n.jsx)(Y,{limit:2e4}),"/20000"]}),(0,n.jsx)(a,{}),(0,n.jsx)(ln,{open:nn,onOpenChange:mn,suggestions:un,onSearchChange:cn,onAddMention:function(){},entryComponent:w,popoverContainer:function(_){var d=_.children;return(0,n.jsx)("div",{style:{minWidth:"100px",position:"absolute"},children:d})}})]})}},21716:function(H,c,e){e.r(c),e.d(c,{default:function(){return M}});var T=e(93236),g=e(24552),x=e(62086);function M(){return(0,x.jsx)(g.default,{})}},52007:function(H,c,e){e.r(c),e.d(c,{camelToDash:function(){return Z},createElement:function(){return W},createElementMap:function(){return X},fileToBlob:function(){return P},fileToBlobUrl:function(){return V},getAllAttributes:function(){return F},getFileName:function(){return I},getSuffix:function(){return K},nodeToString:function(){return y},objToString:function(){return N}});var T=e(25359),g=e.n(T),x=e(49811),M=e.n(x),B=e(37635),E=e.n(B),m=e(93525),D=e.n(m),O=e(57213),v=e.n(O),L=e(54306),p=e.n(L),R=e(17607),K=function(n){var t;return((t=/[^.]*$/g.exec(n))===null||t===void 0?void 0:t[0])||""},I=function(n){var t;return((t=/[^/]*$/g.exec(n))===null||t===void 0?void 0:t[0])||""},W=function r(n){if(typeof n=="string")return document.createTextNode(n);var t=document.createElement(n.type),o=(0,R.Z)(n,["type","children"]);if(Object.entries(o).forEach(function(a){var f=p()(a,2),b=f[0],h=f[1];t.setAttribute(b,N(h))}),n.children){var i=n.children.map(function(a){return r(a)});i.forEach(function(a){return t.appendChild(a)})}return t},X=function r(n){if(!(n instanceof HTMLElement))return{type:"span"};var t=n.tagName.toLocaleLowerCase(),o=F(n),i=n.children;return v()(v()({type:t},o),{},{children:i.length?D()(i).map(function(a){return r(a)}):[n.innerText]})},F=function(n){var t=D()(n.attributes).map(function(o){return o.name});return Object.fromEntries(t.map(function(o){return[o,n.getAttribute(o)]}))},N=function(n){return E()(n)!=="object"?n:Object.entries(n).map(function(t){var o=p()(t,2),i=o[0],a=o[1];return"".concat(Z(i),":").concat(a,";")}).join("")};function Z(r){return r.replace(/[A-Z]/g,function(n){return"-"+n.toLowerCase()})}var y=function(n){if(typeof n=="string")return n;var t=document.createElement("div");return t.appendChild(n),t.innerHTML};function P(r){var n=new FileReader;return new Promise(function(t){n.addEventListener("load",function(o){var i,a,f;if(E()((i=o.target)===null||i===void 0?void 0:i.result)==="object"&&(a=o.target)!==null&&a!==void 0&&a.result){var b;f=new Blob([(b=o.target)===null||b===void 0?void 0:b.result])}else{var h;f=(h=o.target)===null||h===void 0?void 0:h.result}t(f)}),n.readAsArrayBuffer(r)})}function V(r){return j.apply(this,arguments)}function j(){return j=M()(g()().mark(function r(n){var t;return g()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,P(n);case 2:return t=i.sent,i.abrupt("return",URL.createObjectURL(t));case 4:case"end":return i.stop()}},r)})),j.apply(this,arguments)}}}]);
