"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[704,750,418,975,619],{22833:function(O,e,n){n.r(e),n.d(e,{default:function(){return N}});var x=n(52510),l=n.n(x),E=n(84875),u=n.n(E),d={avatar:"avatar___V3O9H"},m=n(62086),M;(function(s){s.CIRCLE="circle",s.SQUARE="square"})(M||(M={}));function N(s){var h=s.info.shape===M.SQUARE,t=u()({"h-8":!0,"w-8":!0,"min-w-max":!0}),i=u()(l()({"h-full w-8 bg-sky-400 content-center":!0,rounded:h,"rounded-full":!h},d.avatar,!0));if(s.info.avatar)return(0,m.jsx)("div",{className:t,children:(0,m.jsx)("img",{className:"h-full w-full",src:s.info.avatar})});var S=(s.info.nickname||s.info.name)[0];return(0,m.jsx)("div",{className:t,children:(0,m.jsx)("div",{className:i,children:S})})}},83773:function(O,e,n){n.r(e),n.d(e,{IN:function(){return x}});var x="in"},80038:function(O,e,n){n.r(e),n.d(e,{default:function(){return h}});var x=n(52510),l=n.n(x),E=n(84875),u=n.n(E),d={box:"box___k83VP",msgBox:"msgBox___CLTFk",in:"in___FxKfJ",out:"out___dQC37",system:"system___fGfxg",systemText:"systemText___emM3a"},m=n(87848),M=n(83773),N=n(22833),s=n(62086);function h(t){var i;if(t.message.type===m.MessageType.SYSTEM)return typeof t.message.message!="string"?null:(0,s.jsx)("div",{className:d.system,children:(0,s.jsx)("div",{className:d.systemText,children:t.message.message})});var S=t.message.sendType===M.IN,g=u()((i={},l()(i,d.in,S),l()(i,d.out,!S),l()(i,d.box,!0),i)),B=u()({"flex flex-col":!0,"ml-2":S,"mr-2":!S}),R=u()({"text-xs text-gray-300":!0,"text-right":!S}),I=t.member.nickname||t.member.name;return(0,s.jsxs)("div",{className:g,children:[(0,s.jsx)(N.default,{info:t.member}),(0,s.jsxs)("div",{className:B,children:[(0,s.jsx)("p",{className:R,children:I}),(0,s.jsx)("div",{style:t.style,className:d.msgBox,children:t.children})]})]})}},78318:function(O,e,n){n.r(e),n.d(e,{default:function(){return X}});var x=n(52510),l=n.n(x),E=n(57213),u=n.n(E),d=n(54306),m=n.n(d),M=n(93236),N=n(49084);function s(A,K,T){var L=A==null?void 0:(0,N.Z)(A,K);return L===void 0?T:L}var h=s,t=n(80038),i=n(23336),S=n(93588),g=n(94338),B=n(98857),R=n(74183),I=n(84544),U=n(74229),D=n(53056),Z=n(75524),c=n(62086);function X(A){if(!h(A.list,"length"))return null;var K=(0,M.useState)({}),T=m()(K,2),L=T[0],Y=T[1],H=function(a,W){Y(u()(u()({},L),{},l()({},a.uuid,W)))};return(0,c.jsx)("div",{className:"p-4",children:A.list.map(function(o){var a=A.members.find(function(G){return G.id===o.sendId})||{id:String(+new Date),name:""},W=L[o.uuid];return(0,c.jsx)(t.default,{style:W,member:a,message:o,children:{system:(0,c.jsx)(i.default,{message:o}),text:(0,c.jsx)(S.default,{message:o}),voice:(0,c.jsx)(g.default,{message:o}),video:(0,c.jsx)(B.default,{message:o}),file:(0,c.jsx)(R.default,{message:o}),robot:(0,c.jsx)(I.default,{message:o}),richtext:(0,c.jsx)(U.default,{message:o}),quote:(0,c.jsx)(D.default,{onSetStyleMap:H,message:o}),img:(0,c.jsx)(Z.default,{message:o})}[o.type]},o.uuid)})})}},23336:function(O,e,n){n.r(e),n.d(e,{default:function(){return l}});var x=n(62086);function l(E){return(0,x.jsx)("div",{})}},24552:function(O,e,n){n.r(e),n.d(e,{default:function(){return ln}});var x=n(25359),l=n.n(x),E=n(49811),u=n.n(E),d=n(54306),m=n.n(d),M=n(12342),N=n.n(M),s=n(57213),h=n.n(s),t=n(93236),i=n(17607),S=n(66466),g=n(22018),B=n(22978),R=n(48721),I=n(61793),U=n(85108),D=n(6420),Z=n(79766),c=n(93900),X=n(80382),A=n(66680),K=n(88825),T={editor:"editor___AcobX",emojiBox:"emojiBox___OCwv_",count:"count___gjETG",counterOverLimit:"counterOverLimit___m7ZyI"},L={mention:"mention___e08UF",mentionSuggestions:"mentionSuggestions___xV0Oy",mentionSuggestionsEntryContainer:"mentionSuggestionsEntryContainer___RS_bu",mentionSuggestionsEntryContainerLeft:"mentionSuggestionsEntryContainerLeft___Obkfm",mentionSuggestionsEntryContainerRight:"mentionSuggestionsEntryContainerRight___aAbxo",mentionSuggestionsEntry:"mentionSuggestionsEntry___c0x64",mentionSuggestionsEntryFocused:"mentionSuggestionsEntryFocused___jKUAV",mentionSuggestionsEntryText:"mentionSuggestionsEntryText___uC5ih",mentionSuggestionsEntryTitle:"mentionSuggestionsEntryTitle___feT0M",mentionSuggestionsEntryAvatar:"mentionSuggestionsEntryAvatar___ar8FJ"},Y=n(52007),H=n(87848),o=n(12881),a=n(62086),W=["mention","theme","searchValue","isFocused"],G=(0,I.Z)({useNativeArt:!0}),nn=(0,U.Z)(),tn=G.EmojiSuggestions,en=G.EmojiSelect,sn=(0,D.Z)({component:function(C){var v=C.href,V=(0,i.Z)(C,["className"]);return(0,a.jsx)("a",h()(h()({},V),{},{style:{color:"#5e93c5",textDecoration:"none"},onClick:function(){return window.open(v,"_blank")}}))}}),b=(0,Z.Z)({theme:{counter:T.counter,counterOverLimit:T.counterOverLimit}}),an=b.CharCounter,Rn=g.KeyBindingUtil.hasCommandModifier;function on(j){return j.code==="KeyZ"?"undo":j.keyCode===13&&!j.shiftKey?"send-msg":(0,g.getDefaultKeyBinding)(j)}function rn(j){var C=j.mention,v=j.theme,V=j.searchValue,$=j.isFocused,Q=N()(j,W);return(0,a.jsx)("div",h()(h()({},Q),{},{children:(0,a.jsx)("div",{className:v==null?void 0:v.mentionSuggestionsEntryContainer,children:(0,a.jsxs)("div",{className:v==null?void 0:v.mentionSuggestionsEntryContainerRight,children:[(0,a.jsx)("div",{className:v==null?void 0:v.mentionSuggestionsEntryText,children:C.name}),(0,a.jsx)("div",{className:v==null?void 0:v.mentionSuggestionsEntryTitle,children:C.title})]})})}))}function ln(j){var C=(0,t.useRef)(null),v=(0,t.useState)(function(){return g.EditorState.createEmpty()}),V=m()(v,2),$=V[0],Q=V[1],un=(0,t.useState)(!1),p=m()(un,2),dn=p[0],mn=p[1],vn=(0,S.tT)("im.member"),k=vn.members,fn=(0,S.tT)("im.message"),gn=fn.setMessages,cn=(0,t.useState)(k),w=m()(cn,2),yn=w[0],xn=w[1],q=(0,t.useMemo)(function(){var r=(0,R.ZP)({entityMutability:"IMMUTABLE",theme:L,mentionPrefix:"@",supportWhitespace:!0}),f=r.MentionSuggestions,y=[r,G,nn,sn,b];return{plugins:y,MentionSuggestions:f}},[]),hn=q.MentionSuggestions,Sn=q.plugins,jn=(0,t.useCallback)(function(r){Q(r)},[]),En=(0,t.useCallback)(function(r){mn(r)},[]),Cn=(0,t.useCallback)(function(r){var f=r.value;xn((0,R.zk)(f,k))},[]),Mn=function(){var f=g.EditorState.createEmpty();Q(f),setTimeout(function(){var y,P;(y=C.current)===null||y===void 0||y.blur(),(P=C.current)===null||P===void 0||P.focus()})},Tn=function(){var r=u()(l()().mark(function f(){var y,P,J;return l()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if((y=C.current.editor.editor)!==null&&y!==void 0&&y.firstChild){F.next=2;break}return F.abrupt("return");case 2:return J=(0,Y.createElementMap)((P=C.current.editor.editor)===null||P===void 0?void 0:P.firstChild),F.next=5,gn({type:H.MessageType.RICHTEXT,uuid:(0,o.Z)(),sendId:"2",send:"\u674E\u56DB",message:[J],createTime:+new Date,sendType:H.SendType.OUT});case 5:Mn(),setTimeout(function(){var z;(z=j.messageRef)===null||z===void 0||z.scrollTo({top:9999999999999,behavior:"smooth"})});case 7:case"end":return F.stop()}},f)}));return function(){return r.apply(this,arguments)}}(),Pn=function(f){var y=$.getCurrentContent(),P=y.createEntity("IMAGE","IMMUTABLE",{src:f}),J=P.getLastCreatedEntityKey(),_=g.EditorState.set($,{currentContent:P});return g.AtomicBlockUtils.insertAtomicBlock(_,J," ")},Nn=function(f){var y=URL.createObjectURL(new Blob(f));Q(Pn(y))},An=function(f){return f==="send-msg"?(Tn(),"handled"):"not-handled"};return(0,a.jsxs)("div",{className:T.editor,onClick:function(){C.current.focus()},children:[(0,a.jsx)("div",{className:T.emojiBox,children:(0,a.jsx)(en,{})}),(0,a.jsx)(B.ZP,{editorKey:"editor",editorState:$,onChange:jn,plugins:Sn,ref:C,keyBindingFn:on,handleKeyCommand:An,handlePastedFiles:Nn}),(0,a.jsxs)("span",{className:T.count,children:[(0,a.jsx)(an,{limit:2e4}),"/20000"]}),(0,a.jsx)(tn,{}),(0,a.jsx)(hn,{open:dn,onOpenChange:En,suggestions:yn,onSearchChange:Cn,onAddMention:function(){},entryComponent:rn,popoverContainer:function(f){var y=f.children;return(0,a.jsx)("div",{style:{minWidth:"100px",position:"absolute"},children:y})}})]})}},21716:function(O,e,n){n.r(e),n.d(e,{default:function(){return u}});var x=n(93236),l=n(24552),E=n(62086);function u(d){return(0,E.jsx)(l.default,{messageRef:d.messageRef})}},86751:function(O,e,n){n.r(e),n.d(e,{default:function(){return S}});var x=n(54306),l=n.n(x),E=n(52510),u=n.n(E),d=n(78318),m={box:"box___IpXK4",messages:"messages___GotYm",send:"send___nFnTt"},M=n(21716),N=n(84875),s=n.n(N),h=n(66466),t=n(93236),i=n(62086);function S(){var g,B=s()((g={},u()(g,m.send,!0),u()(g,"unreset",!0),g)),R=(0,h.tT)("im.message"),I=R.messages,U=(0,h.tT)("im.member"),D=U.members,Z=(0,t.useState)(null),c=l()(Z,2),X=c[0],A=c[1],K=(0,t.useRef)(null);return(0,t.useEffect)(function(){A(K.current)},[]),(0,i.jsxs)("div",{className:m.box,children:[(0,i.jsx)("div",{ref:K,className:m.messages,children:(0,i.jsx)(d.default,{list:I,members:D})}),(0,i.jsx)("div",{className:B,children:(0,i.jsx)(M.default,{messageRef:X})})]})}}}]);
